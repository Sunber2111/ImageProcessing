{"ast":null,"code":"const {\n  createCanvas,\n  Image,\n  loadImage,\n  createImageData\n} = require('canvas');\n\nconst sizeof = require('object-sizeof');\n\nconst cv = require('./opencv');\n\nconst color2Gray = async url => {\n  const image = await loadImage(url);\n  const src = cv.imread(image);\n  console.log(sizeof(src));\n  let dst = new cv.Mat(src.size(), 0);\n  let Midle = 0;\n\n  for (let row = 0; row < src.rows; row++) {\n    for (let col = 0; col < src.cols; col++) {\n      dst.ucharPtr(row, col)[0] = Math.round((src.ucharPtr(row, col)[0] + src.ucharPtr(row, col)[1] + src.ucharPtr(row, col)[2]) / 3);\n    }\n  }\n\n  const canvas = createCanvas(image.width, image.height);\n  cv.imshow(canvas, dst);\n  return canvas;\n};\n\nmodule.exports = {\n  color2Gray\n};","map":{"version":3,"sources":["D:/XLA/project/node_modules/opencv/index.js"],"names":["createCanvas","Image","loadImage","createImageData","require","sizeof","cv","color2Gray","url","image","src","imread","console","log","dst","Mat","size","Midle","row","rows","col","cols","ucharPtr","Math","round","canvas","width","height","imshow","module","exports"],"mappings":"AACA,MAAM;AAAEA,EAAAA,YAAF;AAAgBC,EAAAA,KAAhB;AAAwBC,EAAAA,SAAxB;AAAmCC,EAAAA;AAAnC,IAAuDC,OAAO,CAAC,QAAD,CAApE;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,eAAD,CAAtB;;AACA,MAAME,EAAE,GAAGF,OAAO,CAAC,UAAD,CAAlB;;AAEA,MAAMG,UAAU,GAAG,MAAMC,GAAN,IAAa;AAE5B,QAAMC,KAAK,GAAG,MAAMP,SAAS,CAACM,GAAD,CAA7B;AAEA,QAAME,GAAG,GAAGJ,EAAE,CAACK,MAAH,CAAUF,KAAV,CAAZ;AAEAG,EAAAA,OAAO,CAACC,GAAR,CAAYR,MAAM,CAACK,GAAD,CAAlB;AAEA,MAAII,GAAG,GAAG,IAAIR,EAAE,CAACS,GAAP,CAAWL,GAAG,CAACM,IAAJ,EAAX,EAAuB,CAAvB,CAAV;AAEA,MAAIC,KAAK,GAAG,CAAZ;;AAEA,OAAK,IAAIC,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAGR,GAAG,CAACS,IAA5B,EAAkCD,GAAG,EAArC,EAAyC;AACrC,SAAK,IAAIE,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAGV,GAAG,CAACW,IAA5B,EAAkCD,GAAG,EAArC,EAAyC;AAErCN,MAAAA,GAAG,CAACQ,QAAJ,CAAaJ,GAAb,EAAkBE,GAAlB,EAAuB,CAAvB,IAA4BG,IAAI,CAACC,KAAL,CAAW,CAACd,GAAG,CAACY,QAAJ,CAAaJ,GAAb,EAAkBE,GAAlB,EAAuB,CAAvB,IAA4BV,GAAG,CAACY,QAAJ,CAAaJ,GAAb,EAAkBE,GAAlB,EAAuB,CAAvB,CAA5B,GAAwDV,GAAG,CAACY,QAAJ,CAAaJ,GAAb,EAAkBE,GAAlB,EAAuB,CAAvB,CAAzD,IAAsF,CAAjG,CAA5B;AAEH;AACJ;;AAED,QAAMK,MAAM,GAAGzB,YAAY,CAACS,KAAK,CAACiB,KAAP,EAAcjB,KAAK,CAACkB,MAApB,CAA3B;AAEArB,EAAAA,EAAE,CAACsB,MAAH,CAAUH,MAAV,EAAkBX,GAAlB;AAEA,SAAOW,MAAP;AACH,CAzBD;;AA2BAI,MAAM,CAACC,OAAP,GAAiB;AACbvB,EAAAA;AADa,CAAjB","sourcesContent":["\r\nconst { createCanvas, Image , loadImage, createImageData } = require('canvas')\r\nconst sizeof = require('object-sizeof')\r\nconst cv = require('./opencv')\r\n\r\nconst color2Gray = async url => {\r\n\r\n    const image = await loadImage(url)\r\n\r\n    const src = cv.imread(image)\r\n\r\n    console.log(sizeof(src))\r\n\r\n    let dst = new cv.Mat(src.size(), 0)\r\n\r\n    let Midle = 0\r\n\r\n    for (let row = 0; row < src.rows; row++) {\r\n        for (let col = 0; col < src.cols; col++) {\r\n\r\n            dst.ucharPtr(row, col)[0] = Math.round((src.ucharPtr(row, col)[0] + src.ucharPtr(row, col)[1] + src.ucharPtr(row, col)[2]) / 3)\r\n\r\n        }\r\n    }    \r\n\r\n    const canvas = createCanvas(image.width, image.height)\r\n\r\n    cv.imshow(canvas, dst)\r\n\r\n    return canvas\r\n}\r\n\r\nmodule.exports = {\r\n    color2Gray\r\n}"]},"metadata":{},"sourceType":"script"}